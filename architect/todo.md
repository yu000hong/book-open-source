# TODO


[Making Your Services More Rreliable](https://kevin.burke.dev/slides/reliable-http/)

[IM技术架构](https://github.com/xiancloud/im)


### IM协议应该可以支持负载均衡

所有的客户端通过域名连接后端的IM服务器，可以通过DNS轮询的方式实现负载均衡。但DNS由于存在多级缓存，使得DNS修改一般至少要经过10分钟级别甚至是小时级别的时间才能完全生效。所以，DNS负载均衡对于瞬时爆量的情况，扩容之后没法尽快生效，让客户端连接到扩容之后的机器。

> 修改DNS服务器可以很快同步到顶级域服务器并在网络中生效。但是，域名服务商处NS记录的TTL值通常设置为48小时，这样假如某些地区Local DNS缓存了域名的NS记录，则最长需要48小时才能刷新成新的NS记录，变更为修改后的DNS服务器。

我们可以考虑在**协议层面**增加一个负载均衡的操作，IM服务器发送一个重定向指令让客户端断线重连到重定向的服务器，这样就达到了负载均衡的目的。