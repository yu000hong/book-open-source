# 慢客户端攻击

在慢速客户端攻击中，攻击者故意向服务器发送多个部分HTTP请求，以在服务器上执行HTTP DoS攻击。客户端尝试减慢请求或响应的速度，以至于它长时间保持服务器上的连接和内存资源打开，但不会触发会话超时。

执行此攻击的常见方法包括：

- **Slow HTTP Headers Vulnerability (Slowloris)** ：如Slowloris HTTP DoS（ http://ha.ckers.org/slowloris/ ）所述，使用此技术，客户端永远不会完成发送标头。它会定期逐个发送标头，以防止套接字关闭，从而将Web服务器捆绑在一起。特别是，当线程服务器试图限制允许的线程数量时，它们往往容易受到攻击。 Slowloris必须等待所有套接字在成功使用之前可用，因此对于高流量网站，网站可能需要一段时间才能释放其套接字。

- **Slow HTTP POST Vulnerability (RU-Dead-Yet or RUDY)** ：使用此技术，客户端尝试使用长格式字段提交来对服务器进行DoS。客户端发送所有HTTP标头，其中一个是具有较大值的合法Content-Length标头。然后，客户端以非常慢的速率迭代地将数据注入到表单的post字段中，因此Web应用程序一直等待完整数据到达。一旦多个线程被等待捆绑，服务器最终会耗尽资源并获得DoS。有关第7层DDoS攻击的更多技术细节可以在OWASP讲座中找到：OWASP-Universal-HTTP-DoS（ http://www.hybridsec.com/papers/OWASP-Universal-HTTP-DoS.ppt ）。

- **Slow Read DoS Attack** ：使用此攻击技术，客户端请求完全完成。当服务器响应时，客户端通告非常小的窗口以接受响应数据。对于大响应（例如，文件下载），客户端的慢接收率会长时间占用服务器资源。此类型的多个请求最终可能会导致服务器关闭。

这些请求是第7层DoS攻击。从协议合规的角度来看，它们通常是合法的，因此不会被网络层DDoS设备， IPS / IDS甚至您的ISP检测到。客户端可以隐秘地缓慢地执行服务器，而不会消耗网络上的任何重要带宽，因此它们仍然未被检测到。

### 慢客户端攻击防范如何工作？

以下设置允许识别防止缓慢的客户端请求或响应攻击：

**数据传输率**

Barracuda Web Application Firewall对来自客户端的请求和对客户端的响应所期望的最低数据传输速率。比这慢的数据传输速率被认为是缓慢的。

**最大请求超时**

允许从客户端接收请求的最长时间。如果请求在此时间内未完成，则终止连接，将FIN发送到客户端，并阻止其他请求。

**最大响应超时**

允许向客户端发送响应的最长时间。如果此时响应传输未完成，则终止连接，将Fin发送到客户端，并且不发送对客户端的进一步响应。

**增量请求超时**

此值指定客户端在其中完成请求的初始超时窗口。然后系统使用自适应算法逐渐收缩窗口。如果客户端在收缩窗口中反复无法完成请求，则请求超时窗口收敛为零并且连接被丢弃。如果客户端开始以健康的速率发送数据，则窗口会逐渐扩展。此自适应算法可确保临时网络延迟不会影响正版客户端，但会检测并拒绝持久性慢客户端。

**增量响应超时**

此值指定客户端在其中接收响应的初始超时窗口。然后系统使用自适应算法逐渐收缩窗口。如果客户端在收缩窗口中反复无法接收响应，则响应超时窗口收敛为零并且连接断开。如果客户端开始以健康的速率接收数据，则窗口将逐渐扩展。此自适应算法可确保临时网络延迟不会影响正版客户端，但会检测并拒绝持久性慢客户端。

**例外客户端**

应该免除慢速客户端攻击防范的IP地址。使用不带空格的逗号分隔符指定单个IP地址或IP地址范围，或两者的组合。

